
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction to Numpy &#8212; Practice and theory of brain imaging</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Arrays as images, images as arrays" href="arrays_and_images.html" />
    <link rel="prev" title="What is an image?" href="what_is_an_image.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/reggie.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Practice and theory of brain imaging</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Practice and theory of brain imaging
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The neuroimaging problem
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="the_problem.html">
   The problem and the plan
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The tools
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="to_code.html">
   Ode to code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surviving_computers.html">
   Surviving the computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="the_software.html">
   Our tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="using_jupyter.html">
   Using Jupyter notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="more_on_jupyter.html">
   More on the Jupyter notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="brisk_python.html">
   Brisk introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installing on your computer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Images and code and images
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="what_is_an_image.html">
   What is an image?
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays_and_images.html">
   Arrays as images, images as arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays_3d.html">
   Three-dimensional arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="images_3d.html">
   Three-dimensional images, NIfTI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape_and_3d.html">
   Reshaping and three-dimensional arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boolean_indexing.html">
   Indexing with Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boolean_indexing_nd.html">
   Boolean indexing with more than one dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_to_4d.html">
   Working with four dimensional images, masks and functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape_and_4d.html">
   Reshaping, 4D to 2D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="voxels_by_time.html">
   Voxels and time
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Working reproducibly
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="on_modules.html">
   Modules and scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sys_path.html">
   Where does Python look for modules?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assert.html">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     assert
    </span>
   </code>
   for testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="path_manipulation.html">
   Making and breaking file paths in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coding_style.html">
   Python coding style
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docstrings.html">
   Docstrings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="module_directories.html">
   Module directories
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_testing.html">
   On testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Detecting activation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="voxel_time_courses.html">
   Correlating with voxel time courses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_convolution.html">
   Convolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="convolution_background.html">
   Convolving with the hemodyamic response function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_regression.html">
   Introducing regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regress_one_voxel.html">
   Regression for a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glm_intro.html">
   Introduction to the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mean_test_example.html">
   A worked example of the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_one_voxel.html">
   Modeling a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_multiply.html">
   Estimation for many voxels at the same time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hypothesis_tests.html">
   Hypothesis testing with the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test_one_voxel.html">
   Testing a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="non_tr_onsets.html">
   Using onsets that do not start on a TR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="whole_image_statistics.html">
   Whole-brain t tests and p values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bonferroni_correction.html">
   Notes on the Bonferroni threshold
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Spatial processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="slice_timing.html">
   Slice timing correction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimizing_space.html">
   Calculating transformations between images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="diagonal_zooms.html">
   Encoding zooms (scaling) with a diagonal matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nibabel_affines.html">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     nibabel.affines
    </span>
   </code>
   module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nibabel_apply_affine.html">
   Applying coordinate transforms with
   <code class="docutils literal notranslate">
    <span class="pre">
     nibabel.affines.apply_affine
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="map_coordinates.html">
   General resampling between images with
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.ndimage.map_coordinates
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="image_header_and_affine.html">
   The image header and affine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="images_and_affines.html">
   Images and affines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rotation_2d_3d.html">
   Rotations and rotation matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="resampling_with_ndimage.html">
   Resampling with
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dipy_registration.html">
   Registration with dipy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anterior_cingulate.html">
   Anterior cingulate
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notes on arrays and plots
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="methods_vs_functions.html">
   Methods vs functions in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="allclose.html">
   Testing for near equality with “allclose”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arange.html">
   NumPy arange
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_logical.html">
   Logical operations on Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dot_outer.html">
   Vector and matrix dot products, “np.outer”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newaxis.html">
   Adding length 1 dimensions with newaxis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="array_reductions.html">
   Array reduction operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_random.html">
   Numpy random number generators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subtract_means.html">
   Subtracting the mean from columns or rows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_lines.html">
   Plotting lines in matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subplots.html">
   Subplots and axes in matplotlib
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/nipraxis/textbook/main?urlpath=tree/numpy_intro.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://hub.nipraxis.org/hub/user-redirect/git-pull?repo=https%3A//github.com/nipraxis/textbook&urlpath=tree/textbook/numpy_intro.Rmd&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/nipraxis/textbook/blob/main/numpy_intro.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fnipraxis%2Ftextbook%2Fblob%2Fmain%2Fnumpy_intro.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Deepnote"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_deepnote.svg">
  </span>
<span class="headerbtn__text-container">Deepnote</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/nipraxis/textbook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/nipraxis/textbook/issues/new?title=Issue%20on%20page%20%2Fnumpy_intro.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/numpy_intro.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.Rmd</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-example-data">
   Some example data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-task">
   The task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-the-file">
   Back to the file.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#from-lists-to-arrays">
   From lists to arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-have-a-shape">
   Arrays have a shape
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-have-a-datatype">
   Arrays have a datatype
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-directly-into-arrays">
   Reading directly into arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baby-steps">
   Baby steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-reaction-times">
   Processing reaction times
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boolean-arrays">
   Boolean arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-arrays">
   2D arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshaping">
   Reshaping
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Introduction to Numpy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-example-data">
   Some example data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-task">
   The task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-the-file">
   Back to the file.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#from-lists-to-arrays">
   From lists to arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-have-a-shape">
   Arrays have a shape
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arrays-have-a-datatype">
   Arrays have a datatype
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-directly-into-arrays">
   Reading directly into arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baby-steps">
   Baby steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing-reaction-times">
   Processing reaction times
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boolean-arrays">
   Boolean arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-arrays">
   2D arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reshaping">
   Reshaping
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-numpy">
<h1>Introduction to Numpy<a class="headerlink" href="#introduction-to-numpy" title="Permalink to this headline">#</a></h1>
<p>Numpy is the fundamental package for creating and manipulating <em>arrays</em> in
Python.</p>
<p>As for all Python libraries, we need to load the library into Python, in order to use it.  We use the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement to do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> is now a <em>module</em> available for use.  A module is Python’s term for a library of code and / or data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show what &#39;numpy&#39; is</span>
<span class="n">numpy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;module &#39;numpy&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/numpy/__init__.py&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Numpy is now ready to use, and has the name <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.  For example, if we want to see the value of pi, according to Numpy, we could run this code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793
</pre></div>
</div>
</div>
</div>
<p>Although it is perfectly reasonable to import Numpy with the simplest statement above, in practice, nearly everyone imports Numpy like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make numpy available, but give it the name &quot;np&quot;.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>All this is, is a version of the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement where we <em>rename</em> the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> module to <code class="docutils literal notranslate"><span class="pre">np</span></code>.</p>
<p>Now, instead of using the longer <code class="docutils literal notranslate"><span class="pre">numpy</span></code> as the name for the module, we can use <code class="docutils literal notranslate"><span class="pre">np</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show what &#39;np&#39; is</span>
<span class="n">np</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;module &#39;numpy&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/numpy/__init__.py&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793
</pre></div>
</div>
</div>
</div>
<p>You will see that we nearly always use that <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code> form, and you
will also see that almost everyone else in the Python world does the same
thing.  It’s near-universal convention.  That way, everyone knows you mean
<code class="docutils literal notranslate"><span class="pre">numpy</span></code> when you use <code class="docutils literal notranslate"><span class="pre">np</span></code>.</p>
<section id="some-example-data">
<h2>Some example data<a class="headerlink" href="#some-example-data" title="Permalink to this headline">#</a></h2>
<p>Let’s start with some data, and then go on to process these data with arrays.</p>
<p>We fetch the text file we will be working on:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nipraxis</span>

<span class="c1"># Fetch the file.</span>
<span class="n">stim_fname</span> <span class="o">=</span> <span class="n">nipraxis</span><span class="o">.</span><span class="n">fetch_file</span><span class="p">(</span><span class="s1">&#39;24719.f3_beh_CHYM.csv&#39;</span><span class="p">)</span>
<span class="c1"># Show the filename.</span>
<span class="n">stim_fname</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading file &#39;24719.f3_beh_CHYM.csv&#39; from &#39;https://raw.githubusercontent.com/nipraxis/nipraxis-data/0.4/24719.f3_beh_CHYM.csv&#39; to &#39;/home/runner/.cache/nipraxis/0.4&#39;.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/home/runner/.cache/nipraxis/0.4/24719.f3_beh_CHYM.csv&#39;
</pre></div>
</div>
</div>
</div>
<p>The file is the output from some experimental delivery software that recorded
various aspects of the presented stimuli and the subject’s responses.</p>
<p>The subject saw stimuli every 1.75 seconds or so.  Sometimes they press a
spacebar in response to the stimulus. The file records the subject’s data.
There is one row per trial, where each row records:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">response</span></code> — what response the subject make for this trial (‘None’ or
‘spacebar’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response_time</span></code> — the reaction time for their response (milliseconds after
the stimulus, 0 if no response)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trial_ISI</span></code> — the time between the <em>previous</em> stimulus and this one (the
Interstimulus Interval).  For the first stimulus this is the time from the
start of the experimental software.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trial_shape</span></code> — the name of the stimulus (‘red_star’, ‘red_circle’ and so
on).</p></li>
</ul>
<p>Our task here is to take the values in this file and generate a sequence of times that record the <em>stimulus onset times</em>, in terms of the <em>number of scans</em> since the scanner run started.  More on this below.</p>
<p>Here we open the file as text, and load the lines of the file into memory as a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the lines in the file as a list.</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">stim_fname</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
<span class="c1"># Show the first 5 lines.</span>
<span class="n">lines</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;response,response_time,trial_ISI,trial_shape&#39;,
 &#39;None,0,2000,red_star&#39;,
 &#39;None,0,1000,red_circle&#39;,
 &#39;None,0,2500,green_triangle&#39;,
 &#39;None,0,1500,yellow_square&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-task">
<h2>The task<a class="headerlink" href="#the-task" title="Permalink to this headline">#</a></h2>
<p>Now we can give some more detail of what we need to do.</p>
<ul class="simple">
<li><p>The times in this file are from the experimental software.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">trial_ISI</span></code> values are times <em>between</em> the stimuli.  Thus the first
stimulus occurred 2000 ms after the experimental software started, and the second stimulus occurred 2000 + 1000 = 3000 ms after the experimental software started.  Call these the <code class="docutils literal notranslate"><span class="pre">exp_onset_times</span></code>.</p></li>
<li><p>The scanner started 4 seconds (4000ms) <em>before</em> the experimental software.
So the onset times in relation to the <em>scanner start</em> are 4000 + 2000 = 6000, 4000 + 2000 + 1000 = 7000ms.  Call these the <code class="docutils literal notranslate"><span class="pre">scan_onset_times</span></code>.</p></li>
<li><p>Finally, the scanner starts a new scan each 2 second (2000 ms).  To get the
times in terms of scans we divide the <code class="docutils literal notranslate"><span class="pre">scan_onset_times</span></code> by 2000.  Call these
the <code class="docutils literal notranslate"><span class="pre">scan_onset_in_scans</span></code> These are the times we need for our later
statistical modeling.</p></li>
</ul>
<p>The first four <code class="docutils literal notranslate"><span class="pre">trial_ISI</span></code> values from the lines above are: 2000, 1000, 2500,
1500.</p>
<p>Therefore the first four values for <code class="docutils literal notranslate"><span class="pre">exp_onset_times</span></code> are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First four values of exp_onset_times</span>
<span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span> <span class="o">+</span> <span class="mi">1500</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2000, 3000, 5500, 7000]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">scan_onset_times</span></code> are just these values + 4000:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First four values of scan_onset_times</span>
<span class="p">[</span><span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span><span class="p">,</span>
 <span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">,</span>
 <span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span><span class="p">,</span>
 <span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span> <span class="o">+</span> <span class="mi">1500</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[6000, 7000, 9500, 11000]
</pre></div>
</div>
</div>
</div>
<p>Finally, the <code class="docutils literal notranslate"><span class="pre">scan_onset_in_scans</span></code> values will start:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First four values of scan_onset_in_scans</span>
<span class="p">[(</span><span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">4000</span> <span class="o">+</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span> <span class="o">+</span> <span class="mi">1500</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.0, 3.5, 4.75, 5.5]
</pre></div>
</div>
</div>
</div>
<p>All this is ugly to type out.  Luckily Numpy is an excellent tool for this calculation.</p>
</section>
<section id="back-to-the-file">
<h2>Back to the file.<a class="headerlink" href="#back-to-the-file" title="Permalink to this headline">#</a></h2>
<p>Here are the first five lines of the file again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the first 5 lines.</span>
<span class="n">lines</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;response,response_time,trial_ISI,trial_shape&#39;,
 &#39;None,0,2000,red_star&#39;,
 &#39;None,0,1000,red_circle&#39;,
 &#39;None,0,2500,green_triangle&#39;,
 &#39;None,0,1500,yellow_square&#39;]
</pre></div>
</div>
</div>
</div>
<p>As you can see, the first line in the file gives the names of the fields in each row.  We will throw away that line to start.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lines</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;None,0,2000,red_star&#39;,
 &#39;None,0,1000,red_circle&#39;,
 &#39;None,0,2500,green_triangle&#39;,
 &#39;None,0,1500,yellow_square&#39;,
 &#39;None,0,1500,blue_circle&#39;]
</pre></div>
</div>
</div>
</div>
<p>There is one line for each trial, so the number of lines in the file is also the number of trials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_trials</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="n">n_trials</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>320
</pre></div>
</div>
</div>
</div>
<p>Let’s look at the first line again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;None,0,2000,red_star&#39;
</pre></div>
</div>
</div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">split</span></code> <em>method</em> of the string to split the string at the commas (<code class="docutils literal notranslate"><span class="pre">,</span></code>).  This gives us a list of strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parts</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">parts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;None&#39;, &#39;0&#39;, &#39;2000&#39;, &#39;red_star&#39;]
</pre></div>
</div>
</div>
</div>
<p>This in turn suggests how we could use <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to collect the response times and the trial ISIs into lists, with one element per trial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to hold the response times.</span>
<span class="n">isi_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to hold the trial_isis</span>
<span class="c1"># For each number from 0 up to (not including) the value of n_trials.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Get the corresponding line for trial position i</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c1"># Split at commas</span>
    <span class="n">rt_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># Second thing is response time</span>
    <span class="n">isi_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># Third thing is trialISI</span>
<span class="c1"># Show the first 5 trial ISIs.</span>
<span class="n">isi_list</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2000.0, 1000.0, 2500.0, 1500.0, 1500.0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="from-lists-to-arrays">
<h2>From lists to arrays<a class="headerlink" href="#from-lists-to-arrays" title="Permalink to this headline">#</a></h2>
<p>Lists are useful, but we very often need arrays to help us process the data.</p>
<p>We hope you will see why by example.</p>
<p>You can make an array from a list by using the <code class="docutils literal notranslate"><span class="pre">np.array</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isi_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">isi_list</span><span class="p">)</span>
<span class="n">isi_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2000., 1000., 2500., 1500., 1500., 2000., 2500., 1500., 2000.,
       1000., 1000., 1500., 1500., 2000., 1500., 1500., 1500., 2000.,
       2000., 1500., 2500., 1000., 2500., 1000., 2500., 2000., 2000.,
       1000., 1000., 1000., 1500., 1500., 1500., 1500., 1000., 1000.,
       2500., 1000., 2000., 2000., 2500., 1500., 1500., 1000., 2500.,
       2000., 1000., 1500., 2000., 1500., 2000., 1000., 1000., 2500.,
       1500., 2000., 1000., 1000., 1000., 1000., 2500., 2500., 2000.,
       2500., 2500., 1500., 2000., 1500., 2000., 1000., 1500., 2500.,
       1000., 1000., 2500., 2000., 2500., 2500., 2500., 1500., 1500.,
       1000., 2500., 2500., 2500., 1500., 1000., 2500., 2000., 1500.,
       2000., 2500., 1500., 1500., 2500., 2500., 2000., 2000., 1000.,
       1000., 2000., 2500., 1000., 2000., 2000., 1000., 2000., 2000.,
       1500., 1000., 1000., 1500., 1500., 2500., 2500., 2500., 1500.,
       2500., 1500., 1000., 1500., 2500., 1000., 2000., 2500., 1000.,
       2000., 2500., 1500., 2000., 1000., 1000., 2500., 1500., 2000.,
       1000., 1000., 2500., 1000., 2500., 2500., 2500., 1000., 2000.,
       1000., 1500., 2000., 1500., 1500., 1500., 1000., 1000., 1500.,
       1000., 2500., 2000., 2500., 1500., 2000., 2500., 1000., 1000.,
       2500., 1500., 1500., 1500., 2500., 1000., 2500., 2000., 2000.,
       1000., 2000., 2000., 2000., 2500., 1500., 2000., 2000., 2000.,
       1000., 2000., 2000., 1500., 1000., 1000., 2000., 2000., 1500.,
       1500., 1000., 2000., 1500., 1500., 1000., 2000., 1500., 1000.,
       1500., 2500., 2000., 1000., 2000., 2000., 2000., 1500., 1000.,
       1500., 1500., 1000., 2000., 1000., 1500., 2500., 2000., 2500.,
       2500., 1500., 1000., 2500., 2500., 1000., 2500., 2500., 2000.,
       2000., 1000., 2500., 2500., 1500., 2500., 2000., 2500., 2000.,
       2500., 1000., 1000., 1500., 2500., 1500., 2500., 2500., 1500.,
       1000., 2500., 1500., 2000., 1000., 2000., 2500., 2000., 1500.,
       2500., 2500., 1500., 1500., 1000., 1500., 1500., 1500., 1000.,
       2500., 1500., 2500., 2000., 2500., 1000., 2500., 2000., 2000.,
       2000., 2500., 2000., 1000., 1500., 1000., 2000., 2500., 2500.,
       1000., 1500., 1500., 2000., 2500., 1500., 2000., 1500., 1500.,
       2500., 2500., 1000., 2500., 2000., 1500., 2000., 2500., 2000.,
       2000., 1500., 1000., 1000., 2500., 2000., 2000., 2000., 1500.,
       2000., 1000., 1000., 2000., 1000., 1500., 1500., 2500., 2000.,
       1000., 2500., 1000., 1000., 1000.])
</pre></div>
</div>
</div>
</div>
<p>Let us do the same for the reaction times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rt_list</span><span class="p">)</span>
<span class="c1"># Show the first 15 elements for brevity</span>
<span class="n">rt_list</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 427.0, 0.0, 0.0, 369.0, 0.0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="arrays-have-a-shape">
<h2>Arrays have a shape<a class="headerlink" href="#arrays-have-a-shape" title="Permalink to this headline">#</a></h2>
<p>The array object has <code class="docutils literal notranslate"><span class="pre">shape</span></code> data attached to it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isi_arr</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320,)
</pre></div>
</div>
</div>
</div>
<p>The shape gives the number of dimensions, and the number of elements for each dimension.  We only have a one-dimensional array, so we see one number, which is the number of elements in the array.  We will get on to two-dimensional arrays later.</p>
</section>
<section id="arrays-have-a-datatype">
<h2>Arrays have a datatype<a class="headerlink" href="#arrays-have-a-datatype" title="Permalink to this headline">#</a></h2>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">np.array</span></code> function worked out that all the values in the list
are floating point values, so the array has a <em>datatype</em> (<code class="docutils literal notranslate"><span class="pre">dtype</span></code>) of
<code class="docutils literal notranslate"><span class="pre">float64</span></code> — the standard type of floating point value for Numpy and most other
numerical packages (such as Matlab and R).   The array <code class="docutils literal notranslate"><span class="pre">dtype</span></code> specifies what
type of elements the array does and can contain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isi_arr</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<p>This means that, for example, you cannot put data into this array that can very simply make a floating point value:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isi_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;some text&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">Input In [23],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">isi_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;some text&#39;</span>

<span class="ne">ValueError</span>: could not convert string to float: &#39;some text&#39;
</pre></div>
</div>
</div>
</div>
<p>This is in contrast to a list, where the elements can be a mixture of any type of Python value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.1</span><span class="p">,</span> <span class="mf">15.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">my_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;some_text&#39;</span>
<span class="n">my_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10.1, &#39;some_text&#39;, 0.5]
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-directly-into-arrays">
<h2>Reading directly into arrays<a class="headerlink" href="#reading-directly-into-arrays" title="Permalink to this headline">#</a></h2>
<p>There is another way we could have collected the information from the file, and put it directly into arrays.</p>
<p>We could have started with an array of the right length and type, by using the <code class="docutils literal notranslate"><span class="pre">np.zeros</span></code> function to make an array with all 0.0 values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="n">rt_arr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="n">isi_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">rt_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">isi_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">isi_arr</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2000., 1000., 2500., 1500., 1500.])
</pre></div>
</div>
</div>
</div>
<p>This is a fairly typical use of <code class="docutils literal notranslate"><span class="pre">np.zeros</span></code>.  We make an array of the right size and then fill in the elements later.</p>
</section>
<section id="baby-steps">
<h2>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">#</a></h2>
<p>Let’s proceed in steps.  First let us work out the time for each trial <em>from
the start of the experimental software</em>.   We called these the
<code class="docutils literal notranslate"><span class="pre">exp_onset_times</span></code>.</p>
<p>Because we are careful, we first work out what that would look like if we did it by hand.   Here are the first five ISI values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isi_arr</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2000., 1000., 2500., 1500., 1500.])
</pre></div>
</div>
</div>
</div>
<p>The first value for <code class="docutils literal notranslate"><span class="pre">exp_onset_times</span></code> should be 2000.  The second will be 2000 + 1000.  The third will be 2000 + 1000 + 2500.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2000</span> <span class="o">+</span> <span class="mi">1000</span> <span class="o">+</span> <span class="mi">2500</span> <span class="o">+</span> <span class="mi">1500</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2000, 3000, 5500, 7000]
</pre></div>
</div>
</div>
</div>
<p>We could do the calculation for every trial with a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_onset_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">+</span> <span class="n">isi_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">exp_onset_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_time</span>
<span class="c1"># Show the first 10 values</span>
<span class="n">exp_onset_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2000.,  3000.,  5500.,  7000.,  8500., 10500., 13000., 14500.,
       16500., 17500.])
</pre></div>
</div>
</div>
</div>
<p>That calculation looks right, comparing to our by-hand calculation above.</p>
<p>Luckily, Numpy has a useful function called <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code> that does the cumulative sum of the elements in the array.  As you can see, this does exactly what we want here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the cumulative sum</span>
<span class="n">exp_onset_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">isi_arr</span><span class="p">)</span>
<span class="c1"># Show the first 10 values</span>
<span class="n">exp_onset_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 2000.,  3000.,  5500.,  7000.,  8500., 10500., 13000., 14500.,
       16500., 17500.])
</pre></div>
</div>
</div>
</div>
<p>Next we need to make these experiment time into times in terms of the scanner
start.  We decided to call these the <code class="docutils literal notranslate"><span class="pre">scan_onset_times</span></code>. To do this, we need to
add 4000 to every time.   Of course we could go through and do that with a For
loop:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_onset_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">scan_onset_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_onset_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4000</span>
<span class="n">scan_onset_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6000.,  7000.,  9500., 11000., 12500., 14500., 17000., 18500.,
       20500., 21500.])
</pre></div>
</div>
</div>
</div>
<p>Luckily, however, Numpy will do that for us, because when we add a single number to an array, it has the effect of adding that number to <em>every element</em> in the array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_onset_times</span> <span class="o">=</span> <span class="n">exp_onset_times</span> <span class="o">+</span> <span class="mi">4000</span>
<span class="n">scan_onset_times</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6000.,  7000.,  9500., 11000., 12500., 14500., 17000., 18500.,
       20500., 21500.])
</pre></div>
</div>
</div>
</div>
<p>We now have trial onset times in milliseconds, from the start of the first scan.  We want to recode these numbers in terms of scans since the scanner session started.  We call these the <code class="docutils literal notranslate"><span class="pre">scan_onset_in_scans</span></code>.</p>
<p>For example, the first time is 6000 ms.  The scans each last 2000 ms.  So, in terms of scans, the first time is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_length_ms</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="mi">6000</span> <span class="o">/</span> <span class="n">scan_length_ms</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<p>Luckily — Numpy does division in the same way as it does addition, with a single number against an array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_onset_in_scans</span> <span class="o">=</span> <span class="n">scan_onset_times</span> <span class="o">/</span> <span class="n">scan_length_ms</span>
<span class="n">scan_onset_in_scans</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.  ,  3.5 ,  4.75,  5.5 ,  6.25,  7.25,  8.5 ,  9.25, 10.25,
       10.75])
</pre></div>
</div>
</div>
</div>
</section>
<section id="processing-reaction-times">
<h2>Processing reaction times<a class="headerlink" href="#processing-reaction-times" title="Permalink to this headline">#</a></h2>
<p>OK — we have the stimulus onset times, but what about the times for the <em>responses</em>?</p>
<p>Here are the first 15 reaction times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_arr</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 427.,
         0.,   0., 369.,   0.])
</pre></div>
</div>
</div>
</div>
<p>Notice that there is a reaction time of 0 when there was no response.  We’ll
pretend we haven’t noticed that, for now.</p>
<p>Now we want to calculate the <em>response times</em> in terms of the start of the scanner.  We have the times of the trials onsets in terms of the scanner:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_onset_times</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6000.,  7000.,  9500., 11000., 12500., 14500., 17000., 18500.,
       20500., 21500., 22500., 24000., 25500., 27500., 29000.])
</pre></div>
</div>
</div>
</div>
<p>The response onset times, in terms of the scanner start, are just the trial
onset times, plus the corresponding reaction times.  Of course we could do this
with a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scan_response_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">trial_onset</span> <span class="o">=</span> <span class="n">scan_onset_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">this_rt</span> <span class="o">=</span> <span class="n">rt_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">scan_response_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">trial_onset</span> <span class="o">+</span> <span class="n">this_rt</span>
<span class="n">scan_response_times</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6000.,  7000.,  9500., 11000., 12500., 14500., 17000., 18500.,
       20500., 21500., 22927., 24000., 25500., 27869., 29000.])
</pre></div>
</div>
</div>
</div>
<p>Luckily though, Numpy knows what to do when we add two arrays with the same shape.  It takes each element in the first array and adds the corresponding element in the second array - just like the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop above.</p>
<p>This is call <em>elementwise</em> addition, because it does the addition (or subtraction or division …) <em>element</em> by <em>element</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Same result from adding the two arrays with the same shape.</span>
<span class="n">scan_response_times</span> <span class="o">=</span> <span class="n">scan_onset_times</span> <span class="o">+</span> <span class="n">rt_arr</span>
<span class="n">scan_response_times</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6000.,  7000.,  9500., 11000., 12500., 14500., 17000., 18500.,
       20500., 21500., 22927., 24000., 25500., 27869., 29000.])
</pre></div>
</div>
</div>
</div>
</section>
<section id="boolean-arrays">
<h2>Boolean arrays<a class="headerlink" href="#boolean-arrays" title="Permalink to this headline">#</a></h2>
<p>We still have the problem of the 0 values for reaction time, indicating that there was no response.</p>
<p>We can use Boolean arrays to select the response times that were not equal to zero.</p>
<p>This is just a taster of selecting with Boolean arrays.  See <a class="reference internal" href="boolean_indexing.html"><span class="doc std std-doc">Boolean
indexing</span></a> for more.</p>
<p>Boolean arrays are arrays that contain values that are one of the two Boolean values <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Remember <a class="reference internal" href="brisk_python.html#true-and-false"><span class="std std-ref">Boolean values</span></a>, and
<a class="reference internal" href="brisk_python.html#comparison-operators"><span class="std std-ref">Comparison operators</span></a> from <a class="reference internal" href="brisk_python.html"><span class="doc">Brisk introduction to Python</span></a>.  We can be use comparison operators on arrays, to create Boolean arrays.</p>
<p>Let’s start by looking at the first 15 reaction times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_15_rts</span> <span class="o">=</span> <span class="n">rt_arr</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
<span class="n">first_15_rts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0., 427.,
         0.,   0., 369.,   0.])
</pre></div>
</div>
</div>
</div>
<p>Remember that comparisons are operators that give answers to a <em>comparison
question</em>.  This is how comparisons work on individual values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_15_rts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>What do you think will happen if we do the comparison on the whole array, like this?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">first_15_rts</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
<p>You have seen how Numpy works when adding a single number to an array — it
takes this to mean that you want to add that number <em>to every element in the
array</em>.</p>
<p>Comparisons work the same way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_15_rts_not_zero</span> <span class="o">=</span> <span class="n">first_15_rts</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">first_15_rts_not_zero</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, False, False, False, False, False, False,
       False,  True, False, False,  True, False])
</pre></div>
</div>
</div>
</div>
<p>This is the result of asking the comparison question <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code> of <em>every element in
the array</em>.</p>
<p>So the values that end up in the <code class="docutils literal notranslate"><span class="pre">first_15_rts_not_zero</span></code> array come from these
comparisons:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position 0:&#39;</span><span class="p">,</span> <span class="n">first_15_rts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position 1:&#39;</span><span class="p">,</span> <span class="n">first_15_rts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; ... and so on, up to ...&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position 13:&#39;</span><span class="p">,</span> <span class="n">first_15_rts</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Position 14:&#39;</span><span class="p">,</span> <span class="n">first_15_rts</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Position 0: False
Position 1: False
 ... and so on, up to ...
Position 13: True
Position 14: False
</pre></div>
</div>
</div>
</div>
<p>Here is the equivalent array for all the reaction times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rts_not_zero</span> <span class="o">=</span> <span class="n">rt_arr</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="c1"># Show the first 50 values.</span>
<span class="n">rts_not_zero</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, False, False, False, False, False, False,
       False,  True, False, False,  True, False,  True, False,  True,
       False, False, False, False, False,  True,  True,  True, False,
       False, False,  True, False,  True, False, False, False, False,
       False, False,  True, False, False, False, False,  True,  True,
        True, False, False,  True, False])
</pre></div>
</div>
</div>
</div>
<p>We will <a class="reference internal" href="boolean_indexing.html"><span class="doc std std-doc">soon see</span></a> that we can use these arrays to select elements from other arrays.</p>
<p>Specifically, if we put a Boolean array like <code class="docutils literal notranslate"><span class="pre">rts_not_zero</span></code> between square brackets for another array, that will have the effect of selecting the elements at positions where <code class="docutils literal notranslate"><span class="pre">rts_not_zero</span></code> has True, and throwing away elements where <code class="docutils literal notranslate"><span class="pre">rts_not_zero</span></code> has False.</p>
<p>For example, rushing ahead, we can select the values in <code class="docutils literal notranslate"><span class="pre">rt_arr</span></code> corresponding
to reaction times greater than zero with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt_arr</span><span class="p">[</span><span class="n">rts_not_zero</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([427., 369., 337., 308., 375., 478., 300., 321., 306., 370., 372.,
       372., 342., 382., 318., 371., 450., 442., 452., 381., 351., 394.,
       353., 380., 387., 341., 366., 432., 415., 406., 466., 364., 462.,
       477., 374., 384., 375., 432., 369., 354., 455., 338., 364., 376.,
       345., 299., 308., 381., 375., 438., 325., 371., 377., 314., 297.,
       349., 607., 391., 334., 385., 386., 369., 394., 361., 480., 375.,
       368., 325., 410., 328., 412., 379., 383., 376., 351., 361., 403.,
       411., 447., 590., 328., 376., 410., 433., 370., 353., 353., 386.,
       417., 315., 298., 370., 365., 439., 391., 351., 464., 357., 328.,
       294., 471.])
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-arrays">
<h2>2D arrays<a class="headerlink" href="#d-arrays" title="Permalink to this headline">#</a></h2>
<p>We can also have arrays with more than one dimension.  For example, we can make our original trial and reaction times into a two-dimensional array, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">all_times</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill all of the rows, first column with the isi_arr values.</span>
<span class="n">all_times</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">isi_arr</span>
<span class="c1"># Fill all of the rows, second column with the rt_arr values.</span>
<span class="n">all_times</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rt_arr</span>
<span class="c1"># Show the first 5 rows, and all columns.</span>
<span class="n">all_times</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2000.,    0.],
       [1000.,    0.],
       [2500.,    0.],
       [1500.,    0.],
       [1500.,    0.]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="reshaping">
<h2>Reshaping<a class="headerlink" href="#reshaping" title="Permalink to this headline">#</a></h2>
<p>Finally, we often want to change the <em>shape</em> of arrays.</p>
<p>One common thing we may want to do is to take a 2D array and flatten it out into a 1D array, or visa versa.  That does not make much sense in this particular case, but bear with us.</p>
<p>Remember, the original 2D shape was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_times</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320, 2)
</pre></div>
</div>
</div>
</div>
<p>Now we want to <em>flatten</em> this 2D thing into a 1D thing.   The new shape we want is therefore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_trials</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">new_shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[640]
</pre></div>
</div>
</div>
</div>
<p>We pass the new shape to the <code class="docutils literal notranslate"><span class="pre">np.reshape</span></code> function, along with the array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flattened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">all_times</span><span class="p">,</span> <span class="p">[</span><span class="n">n_trials</span> <span class="o">*</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">flattened</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(640,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The first 10 values.</span>
<span class="n">flattened</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2000.,    0., 1000.,    0., 2500.,    0., 1500.,    0., 1500.,
          0.])
</pre></div>
</div>
</div>
</div>
<p>Here we take the flattened array, and put it back into its original two dimensions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unflattened</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flattened</span><span class="p">,</span> <span class="p">[</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">unflattened</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(320, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the first five rows.</span>
<span class="n">unflattened</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2000.,    0.],
       [1000.,    0.],
       [2500.,    0.],
       [1500.,    0.],
       [1500.,    0.]])
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "nipraxis/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="what_is_an_image.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">What is an image?</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="arrays_and_images.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Arrays as images, images as arrays</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The nipraxis team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>