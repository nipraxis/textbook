

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Notation for regression models &#8212; Practice and theory of brain imaging</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'regression_notation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to the general linear model" href="glm_intro.html" />
    <link rel="prev" title="Regression for a single voxel" href="regress_one_voxel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/reggie.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/reggie.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Practice and theory of brain imaging
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The neuroimaging problem</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="the_problem.html">The problem and the plan</a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The tools</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="to_code.html">Ode to code</a></li>
<li class="toctree-l1"><a class="reference internal" href="surviving_computers.html">Surviving the computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="the_software.html">Our tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_jupyter.html">Using Jupyter notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="more_on_jupyter.html">More on the Jupyter notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="brisk_python.html">Brisk introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing on your computer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Images and code and images</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pathlib.html">Using the <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_is_an_image.html">What is an image?</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy_intro.html">Introduction to Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="boolean_arrays.html">Boolean arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshape_and_2d.html">Two-dimensions, reshaping</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays_and_images.html">Arrays as images, images as arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays_3d.html">Three-dimensional arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="images_3d.html">Three-dimensional images, NIfTI</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshape_and_3d.html">Reshaping and three-dimensional arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="boolean_indexing.html">Indexing with Boolean arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="boolean_indexing_nd.html">Boolean indexing with more than one dimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_to_4d.html">Working with four dimensional images, masks and functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshape_and_4d.html">Reshaping, 4D to 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="voxels_by_time.html">Voxels and time</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Working reproducibly</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="on_modules.html">Modules and scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sys_path.html">Where does Python look for modules?</a></li>
<li class="toctree-l1"><a class="reference internal" href="assert.html">Using <code class="docutils literal notranslate"><span class="pre">assert</span></code> for testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding_style.html">Python coding style</a></li>
<li class="toctree-l1"><a class="reference internal" href="docstrings.html">Docstrings</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_directories.html">Module directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_testing.html">On testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Detecting activation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="voxel_time_courses.html">Correlating with voxel time courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_convolution.html">Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution_background.html">Convolving with the hemodyamic response function</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_regression.html">Introducing regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="regress_one_voxel.html">Regression for a single voxel</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Notation for regression models</a></li>
<li class="toctree-l1"><a class="reference internal" href="glm_intro.html">Introduction to the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mean_test_example.html">A worked example of the general linear model</a></li>

<li class="toctree-l1"><a class="reference internal" href="model_one_voxel.html">Modeling a single voxel</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_multiply.html">Estimation for many voxels at the same time</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypothesis_tests.html">Hypothesis testing with the general linear model</a></li>


<li class="toctree-l1"><a class="reference internal" href="test_one_voxel.html">Testing a single voxel</a></li>

<li class="toctree-l1"><a class="reference internal" href="non_tr_onsets.html">Using onsets that do not start on a TR</a></li>
<li class="toctree-l1"><a class="reference internal" href="whole_image_statistics.html">Whole-brain t tests and p values</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonferroni_correction.html">Notes on the Bonferroni threshold</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spatial processing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="slice_timing.html">Slice timing correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizing_space.html">Calculating transformations between images</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagonal_zooms.html">Encoding zooms (scaling) with a diagonal matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="nibabel_affines.html">The <code class="docutils literal notranslate"><span class="pre">nibabel.affines</span></code> module</a></li>
<li class="toctree-l1"><a class="reference internal" href="nibabel_apply_affine.html">Applying coordinate transforms with <code class="docutils literal notranslate"><span class="pre">nibabel.affines.apply_affine</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="map_coordinates.html">General resampling between images with <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.map_coordinates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="image_header_and_affine.html">The image header and affine</a></li>

<li class="toctree-l1"><a class="reference internal" href="images_and_affines.html">Images and affines</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation_2d_3d.html">Rotations and rotation matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="resampling_with_ndimage.html">Resampling with <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></li>

<li class="toctree-l1"><a class="reference internal" href="dipy_registration.html">Registration with dipy</a></li>

<li class="toctree-l1"><a class="reference internal" href="anterior_cingulate.html">Anterior cingulate</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notes on arrays and plots</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="methods_vs_functions.html">Methods vs functions in NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="allclose.html">Testing for near equality with “allclose”</a></li>
<li class="toctree-l1"><a class="reference internal" href="arange.html">NumPy arange</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy_logical.html">Logical operations on Boolean arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="dot_outer.html">Vector and matrix dot products, “np.outer”</a></li>
<li class="toctree-l1"><a class="reference internal" href="newaxis.html">Adding length 1 dimensions with newaxis</a></li>
<li class="toctree-l1"><a class="reference internal" href="array_reductions.html">Array reduction operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy_random.html">Numpy random number generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="subtract_means.html">Subtracting the mean from columns or rows</a></li>


<li class="toctree-l1"><a class="reference internal" href="plot_lines.html">Plotting lines in matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="subplots.html">Subplots and axes in matplotlib</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/nipraxis/textbook/main?urlpath=tree/regression_notation.Rmd" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://hub.nipraxis.org/hub/user-redirect/git-pull?repo=https%3A//github.com/nipraxis/textbook&urlpath=tree/textbook/regression_notation.Rmd&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/nipraxis/textbook/blob/main/regression_notation.Rmd" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li><a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fnipraxis%2Ftextbook%2Fblob%2Fmain%2Fregression_notation.Rmd" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onDeepnote"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_deepnote.svg">
  </span>
<span class="btn__text-container">Deepnote</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nipraxis/textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nipraxis/textbook/issues/new?title=Issue%20on%20page%20%2Fregression_notation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/regression_notation.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Notation for regression models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sweaty-palms-dangerous-students">Sweaty palms, dangerous students</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#x-y-slope-and-intercept">x, y, slope and intercept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-values-and-errors">Fitted values and errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-notation">Mathematical notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notation-for-fitted-values">Notation for fitted values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approximation-and-errors">Approximation and errors</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="notation-for-regression-models">
<h1>Notation for regression models<a class="headerlink" href="#notation-for-regression-models" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numerical and plotting libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="nn">npl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Only show 6 decimals when printing</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">sps</span>
</pre></div>
</div>
</div>
</div>
<p>This page starts with the model for simple regression, that you have already
see in the <a class="reference internal" href="on_regression.html"><span class="doc std std-doc">regression page</span></a>.</p>
<p>Our purpose is to introduce the <em>mathematical notation</em> for regression models.
You will need this notation to understand the <a class="reference internal" href="glm_intro.html"><span class="doc std std-doc">General Linear Model
(GLM)</span></a>, a standard statistical generalization of <em>multiple
regression</em>.  The GLM is the standard model for statistical analysis of
functional imaging data.</p>
<section id="sweaty-palms-dangerous-students">
<h2>Sweaty palms, dangerous students<a class="headerlink" href="#sweaty-palms-dangerous-students" title="Permalink to this heading">#</a></h2>
<p>You have already seen the data we are using here, in the <a class="reference internal" href="on_regression.html"><span class="doc std std-doc">regression
page</span></a>.</p>
<p>We have measured scores for a “psychopathy” personality trait in 12 students.
We also measured how much sweat each student had on their palms, and we call
this a “clammy” score.  We are looking for a straight-line (linear)
relationship that allows us to use the “clammy” score to predict the
“psychopathy” score.</p>
<p>Here are our particular “psychopathy” and “clammy” scores as arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The values we are trying to predict.</span>
<span class="n">psychopathy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">11.416</span><span class="p">,</span>   <span class="mf">4.514</span><span class="p">,</span>  <span class="mf">12.204</span><span class="p">,</span>  <span class="mf">14.835</span><span class="p">,</span>
      <span class="mf">8.416</span><span class="p">,</span>   <span class="mf">6.563</span><span class="p">,</span>  <span class="mf">17.343</span><span class="p">,</span>  <span class="mf">13.02</span><span class="p">,</span>
     <span class="mf">15.19</span> <span class="p">,</span>  <span class="mf">11.902</span><span class="p">,</span>  <span class="mf">22.721</span><span class="p">,</span>  <span class="mf">22.324</span><span class="p">])</span>

<span class="c1"># The values we will predict with.</span>
<span class="n">clammy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">0.389</span><span class="p">,</span>  <span class="mf">0.2</span>  <span class="p">,</span>  <span class="mf">0.241</span><span class="p">,</span>  <span class="mf">0.463</span><span class="p">,</span>
     <span class="mf">4.585</span><span class="p">,</span>  <span class="mf">1.097</span><span class="p">,</span>  <span class="mf">1.642</span><span class="p">,</span>  <span class="mf">4.972</span><span class="p">,</span>
     <span class="mf">7.957</span><span class="p">,</span>  <span class="mf">5.585</span><span class="p">,</span>  <span class="mf">5.527</span><span class="p">,</span>  <span class="mf">6.964</span><span class="p">])</span>

<span class="c1"># The number of values</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clammy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here is a plot of the two variables, with <code class="docutils literal notranslate"><span class="pre">clammy</span></code> on the x-axis and
<code class="docutils literal notranslate"><span class="pre">psychopathy</span></code> on the y-axis.  We could refer to this plot as “psychopathy” <em>as
a function of</em> “clammy”, where “clammy” is on the x-axis.  By convention we put
the predictor on the x-axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clammy</span><span class="p">,</span> <span class="n">psychopathy</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clamminess of handshake&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Psychopathy score&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Psychopathy score&#39;)
</pre></div>
</div>
<img alt="_images/c52fd23dc6e113b9a2f7db62b35e67c53d0b24ffd38d9bc29bbfa2795e2c9cb7.png" src="_images/c52fd23dc6e113b9a2f7db62b35e67c53d0b24ffd38d9bc29bbfa2795e2c9cb7.png" />
</div>
</div>
<p>We will call the sequence of 12 “clammy” scores — the “clammy” <em>variable</em> or
<em>vector</em>.  A vector is a sequence of values — in this case the sequence of 12
“clammy” scores, one for each student.  Similarly, we have a “psychopathy”
vector of 12 values.</p>
</section>
<section id="x-y-slope-and-intercept">
<h2>x, y, slope and intercept<a class="headerlink" href="#x-y-slope-and-intercept" title="Permalink to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(\newcommand{\yvec}{\vec{y}} \newcommand{\xvec}{\vec{x}} \newcommand{\evec}{\vec{\varepsilon}}\)</span></p>
<p>We could call the “clammy” vector a <em>predictor</em>, but other names for a
predicting vector are <em>regressor</em>, <em>covariate</em>, <em>explanatory variable</em>,
<em>independent variable</em> or <em>exogenous</em> variable.  We also often use the
mathematical notation <span class="math notranslate nohighlight">\(\xvec\)</span> to refer to a predicting vector.  The arrow over
the top of <span class="math notranslate nohighlight">\(\xvec\)</span> reminds us that <span class="math notranslate nohighlight">\(\xvec\)</span> refers to a vector (array, sequence)
of values, rather than a single value.</p>
<p>Just to remind us, let’s give the name <code class="docutils literal notranslate"><span class="pre">x</span></code> to the array (vector) of predicting values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">clammy</span>
</pre></div>
</div>
</div>
</div>
<p>We could call the vector we are trying to predict the <em>predicted variable</em>,
<em>response variable</em>, <em>regressand</em>, <em>dependent variable</em> or <em>endogenous</em>
variable. We also often use the mathematical notation <span class="math notranslate nohighlight">\(\yvec\)</span> to refer to a
predicted vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">psychopathy</span>
</pre></div>
</div>
</div>
</div>
<p>You have already seen the best (minimal mean square error) line that relates
the <code class="docutils literal notranslate"><span class="pre">clammy</span></code> (<code class="docutils literal notranslate"><span class="pre">x</span></code>) scores to the <code class="docutils literal notranslate"><span class="pre">psychopathy</span></code> (<code class="docutils literal notranslate"><span class="pre">y</span></code>) scores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">sps</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinregressResult(slope=0.9992572262138825, intercept=10.071285848579462, rvalue=0.5178777312914014, pvalue=0.0845895203804765, stderr=0.5219718130218388, intercept_stderr=2.2534509778472835)
</pre></div>
</div>
</div>
</div>
<p>Call the slope of the line <code class="docutils literal notranslate"><span class="pre">b</span></code> and the intercept <code class="docutils literal notranslate"><span class="pre">c</span></code> (C for Constant).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">slope</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitted-values-and-errors">
<h2>Fitted values and errors<a class="headerlink" href="#fitted-values-and-errors" title="Permalink to this heading">#</a></h2>
<p>Remember, our predicted or <em>fitted</em> values are given by multiplying the <code class="docutils literal notranslate"><span class="pre">x</span></code>
(<code class="docutils literal notranslate"><span class="pre">clammy</span></code>) values by <code class="docutils literal notranslate"><span class="pre">b</span></code> (the slope) and then adding <code class="docutils literal notranslate"><span class="pre">c</span></code> (the intercept).  In
Numpy that looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitted</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">fitted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([10.459997, 10.271137, 10.312107, 10.533942, 14.65288 , 11.167471,
       11.712066, 15.039593, 18.022376, 15.652137, 15.594181, 17.030113])
</pre></div>
</div>
</div>
</div>
<p>The <em>errors</em> are the differences between the <em>fitted</em> and <em>actual</em> (<code class="docutils literal notranslate"><span class="pre">y</span></code>) values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">fitted</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.956003, -5.757137,  1.891893,  4.301058, -6.23688 , -4.604471,
        5.630934, -2.019593, -2.832376, -3.750137,  7.126819,  5.293887])
</pre></div>
</div>
</div>
</div>
<p>The dashed lines in the plot below represent the <em>errors</em>.  The <code class="docutils literal notranslate"><span class="pre">errors</span></code> values
above represent the (positive and negative) lengths of these dashed lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual values&#39;</span><span class="p">)</span>
<span class="c1"># Plot the predicted values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fitted</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Values predicted from line&#39;</span><span class="p">)</span>
<span class="c1"># Plot the distance between predicted and actual, for all points.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">fitted</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
<span class="c1"># The following code line is just to trick Matplotlib into making a new</span>
<span class="c1"># a single legend entry for the dotted lines.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Errors&#39;</span><span class="p">)</span>
<span class="c1"># Show the legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f5c39926e30&gt;
</pre></div>
</div>
<img alt="_images/dec2c31404b449a92e98c57dccee169db9bc0a697aafac5623bc2d925c41ddbc.png" src="_images/dec2c31404b449a92e98c57dccee169db9bc0a697aafac5623bc2d925c41ddbc.png" />
</div>
</div>
</section>
<section id="mathematical-notation">
<h2>Mathematical notation<a class="headerlink" href="#mathematical-notation" title="Permalink to this heading">#</a></h2>
<p>Our next step is to write out this model more generally and more formally in
mathematical symbols, so we can think about <em>any</em> vector (sequence) of x values
<span class="math notranslate nohighlight">\(\xvec\)</span>, and any sequence (vector) of matching y values <span class="math notranslate nohighlight">\(\yvec\)</span>.  But to start
with, let’s think about the actual set of values we have for <span class="math notranslate nohighlight">\(\xvec\)</span>.  We could
write the actual values in mathematical notation as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\xvec = [ 0.389,  0.2  ,  0.241,  0.463, \\
     4.585,  1.097,  1.642,  4.972, \\
     7.957,  5.585,  5.527,  6.964 ]
\end{split}\]</div>
<p>This means that <span class="math notranslate nohighlight">\(\xvec\)</span> is a sequence of these specific 12 values.  But we
could write <span class="math notranslate nohighlight">\(\xvec\)</span> in a more general way, to be <em>any</em> 12 values, like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\xvec = [ x_1, x_2, x_3, x_4, x_5, x_6,\\
          x_7, x_8, x_9, x_{10}, x_{11}, x_{12} ]
\end{split}\]</div>
<p>This means that <span class="math notranslate nohighlight">\(\xvec\)</span> consists of 12 numbers, <span class="math notranslate nohighlight">\(x_1, x_2 ..., x_{12}\)</span>, where
<span class="math notranslate nohighlight">\(x_1\)</span> can be any number, <span class="math notranslate nohighlight">\(x_2\)</span> can be any number, and so on.</p>
<p><span class="math notranslate nohighlight">\(x_1\)</span> is the value for the first student, <span class="math notranslate nohighlight">\(x_2\)</span> is the value for the second student, and so on.</p>
<p>In our <em>particular case</em>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_1 = 0.389 \\
x_2 = 0.2 \\
... \\
x_{12} = 6.964
\end{split}\]</div>
<p>We can make <span class="math notranslate nohighlight">\(\xvec\)</span> be even more general, by writing it like this:</p>
<div class="math notranslate nohighlight">
\[
\xvec = [ x_1, x_2, ..., x_{n} ]
\]</div>
<p>This means that <span class="math notranslate nohighlight">\(\xvec\)</span> is a sequence of any <span class="math notranslate nohighlight">\(n\)</span> numbers, where <span class="math notranslate nohighlight">\(n\)</span> can be any
whole number, such as 1, 2, 3 …  In our specific case, <span class="math notranslate nohighlight">\(n = 12\)</span>.</p>
<p>Similarly, for our <code class="docutils literal notranslate"><span class="pre">psychopathy</span></code> (<span class="math notranslate nohighlight">\(\yvec\)</span>) values, we can write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\yvec = [ 11.416,   4.514,  12.204,  14.835, \\
8.416,   6.563,  17.343,  13.02, \\
15.19 ,  11.902,  22.721,  22.324 ]
\end{split}\]</div>
<p>More generally we can write <span class="math notranslate nohighlight">\(\yvec\)</span> as a vector of any <span class="math notranslate nohighlight">\(n\)</span> numbers:</p>
<div class="math notranslate nohighlight">
\[
\yvec = [ y_1, y_2, ..., y_{n} ]
\]</div>
</section>
<section id="notation-for-fitted-values">
<h2>Notation for fitted values<a class="headerlink" href="#notation-for-fitted-values" title="Permalink to this heading">#</a></h2>
<p>If we have <span class="math notranslate nohighlight">\(n\)</span> values in <span class="math notranslate nohighlight">\(\xvec\)</span> and <span class="math notranslate nohighlight">\(\yvec\)</span> then we have <span class="math notranslate nohighlight">\(n\)</span> <em>fitted</em> values.</p>
<p>Write the fitted value for the first student as <span class="math notranslate nohighlight">\(\hat{y}_1\)</span>, that for the
second as <span class="math notranslate nohighlight">\(\hat{y}_2\)</span>, and so on:</p>
<div class="math notranslate nohighlight">
\[
\vec{\hat{y}} = [ \hat{y}_1, \hat{y}_2, ..., \hat{y}_n ]
\]</div>
<p>Read the <span class="math notranslate nohighlight">\(\hat{ }\)</span> over the <span class="math notranslate nohighlight">\(y\)</span> as “estimated”, so <span class="math notranslate nohighlight">\(\hat{y}_1\)</span> is our
<em>estimate</em> for <span class="math notranslate nohighlight">\(y_1\)</span>, given the model.</p>
<p>Our regression model says each fitted value comes about by multiplying the
corresponding <span class="math notranslate nohighlight">\(x\)</span> value by <span class="math notranslate nohighlight">\(b\)</span> (the slope) and then adding <span class="math notranslate nohighlight">\(c\)</span> (the intercept).</p>
<p>So, the fitted values are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{y}_1 = b x_1 + c \\
\hat{y}_2 = b x_2 + c \\
... \\
\hat{y}_n = b x_n + c
\end{split}\]</div>
<p>More compactly:</p>
<div class="math notranslate nohighlight">
\[
\vec{\hat{y}} = [ b x_1 + c, b x_2 + c, ..., b x_n + c ]
\]</div>
<p>We often use <span class="math notranslate nohighlight">\(i\)</span> as a general <em>index</em> into the vectors.  So, instead of
writing:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{y}_1 = b x_1 + c \\
\hat{y}_2 = b x_2 + c \\
... \\
\hat{y}_n = b x_n + c
\end{split}\]</div>
<p>we use <span class="math notranslate nohighlight">\(i\)</span> to mean any whole number from 1 through <span class="math notranslate nohighlight">\(n\)</span>, and so:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{y}_i = b x_i + c \\
\text{for } i \in [ 1, 2, ... n]
\end{split}\]</div>
<p>For the second line above, read <span class="math notranslate nohighlight">\(\in\)</span> as “in”, and the whole line as “For <span class="math notranslate nohighlight">\(i\)</span>
in 1 through <span class="math notranslate nohighlight">\(n\)</span>”, or as “Where <span class="math notranslate nohighlight">\(i\)</span> can take any value from 1 through <span class="math notranslate nohighlight">\(n\)</span>
inclusive”.</p>
<p>We mean here, that for any whole number <span class="math notranslate nohighlight">\(i\)</span> from 1 through <span class="math notranslate nohighlight">\(n\)</span>, the fitted
value <span class="math notranslate nohighlight">\(\hat{y}_i\)</span> (e.g. <span class="math notranslate nohighlight">\(\hat{y}_3\)</span>, where <span class="math notranslate nohighlight">\(i=3\)</span>) is given by <span class="math notranslate nohighlight">\(b\)</span> times the
corresponding <span class="math notranslate nohighlight">\(x\)</span> value (<span class="math notranslate nohighlight">\(x_3\)</span> where <span class="math notranslate nohighlight">\(i=3\)</span>) plus <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>The error vector <span class="math notranslate nohighlight">\(\vec{e}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
\vec{e} = [ e_1, e_2, ..., e_n ]
\]</div>
<p>For our linear model, the errors are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{e} = [ y_1 - \hat{y}_1, y_2 - \hat{y}_2, ..., y_n - \hat{y}_n ] \\
= [ y_1 - (b x_1 + c), y_2 - (b x_2 + c), ..., y_n - (b x_n + c) ] \\
\end{split}\]</div>
<p>Again, we could write this same idea with the general index <span class="math notranslate nohighlight">\(i\)</span> as:</p>
<div class="math notranslate nohighlight">
\[
e_i = y_i - (b x_i + c)
\]</div>
</section>
<section id="approximation-and-errors">
<h2>Approximation and errors<a class="headerlink" href="#approximation-and-errors" title="Permalink to this heading">#</a></h2>
<p>Our straight line model says that the <span class="math notranslate nohighlight">\(y_i\)</span> values are approximately predicted
by the fitted values <span class="math notranslate nohighlight">\(\hat{y}_i = b x_i + c\)</span>.</p>
<div class="math notranslate nohighlight">
\[
y_i \approx bx_i + c
\]</div>
<p>Read <span class="math notranslate nohighlight">\(\approx\)</span> above as <em>approximately equal to</em>.</p>
<p>With the <span class="math notranslate nohighlight">\(\approx\)</span>, we are accepting that we will not succeed in explaining our
psychopathy values exactly. We can rephrase this by saying that each
observation is equal to the predicted value (from the formula above) plus the
remaining error for each observation:</p>
<div class="math notranslate nohighlight">
\[
y_i = bx_i + c + e_i
\]</div>
<p>Of course this must be true for our calculated errors because we calculated
them with:</p>
<div class="math notranslate nohighlight">
\[
e_i = y_i - (b x_i + c)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">errors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "nipraxis/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="regress_one_voxel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Regression for a single voxel</p>
      </div>
    </a>
    <a class="right-next"
       href="glm_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to the general linear model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sweaty-palms-dangerous-students">Sweaty palms, dangerous students</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#x-y-slope-and-intercept">x, y, slope and intercept</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitted-values-and-errors">Fitted values and errors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-notation">Mathematical notation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notation-for-fitted-values">Notation for fitted values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approximation-and-errors">Approximation and errors</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The nipraxis team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>